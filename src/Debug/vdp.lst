Zilog eZ80 Macro Assembler Version 4.3 (19073001) RELISTED01-Mar-23     16:39:41     page:   1


PC     Object              I  Line    Source 
                           A     1    ; Zilog eZ80 ANSI C Compiler Release 3.4
                           A     2    ; -nomodsect -optsize -noreduceopt -nopadbranch
                           A     3    ; -peephole -globalopt -localcse -const=ROM 
                           A     4    	FILE	"..\vdp.c"
                           A     5    	.assume ADL=1
                           A     6    .DEBUG "C"
                           A     7    	SEGMENT CODE
                           A     8    ;    1	#include <defines.h>
                           A     9    ;    2	#include "mos-interface.h"
                           A    10    ;    3	
                           A    11    ;    4	// Generic functions
                           A    12    ;    5	
                           A    13    ;    6	void vdp_mode(unsigned char mode)
                           A    14    ;    7	{
0401F1                     A    15    _vdp_mode:
                           A    16    .DEFINE "_vdp_mode"
                           A    17    
                           A    18    .VALUE _vdp_mode
                           A    19    
                           A    20    .CLASS 2
                           A    21    
                           A    22    .TYPE 65
                           A    23    
                           A    24    .ENDEF
                           A    25    
                           A    26    .BEGFUNC "vdp_mode",7,"_vdp_mode"
                           A    27    
                           A    28    .LINE 7
                           A    29    
                           A    30    .DEFINE "mode"
                           A    31    
                           A    32    .CLASS 65
                           A    33    
                           A    34    .VALUE 6
                           A    35    
                           A    36    .TYPE 12
                           A    37    
                           A    38    .ENDEF
                           A    39    
0401F1 DDE5                A    40    	PUSH	IX
0401F3 DD210000 00         A    41    	LD	IX,0
0401F8 DD39                A    42    	ADD	IX,SP
                           A    43    ;    8	    putch(22);
                           A    44    .LINE 8
                           A    45    
0401FA 01160000            A    46    	LD	BC,22
0401FE C5                  A    47    	PUSH	BC
0401FF CD 41 03 04         A    48    	CALL	_putch
040203 C1                  A    49    	POP	BC
                           A    50    ;    9	    putch(mode);
                           A    51    .LINE 9
                           A    52    
040204 DD7E06              A    53    	LD	A,(IX+%6)
040207 B7ED62              A    54    	UEXT	HL
04020A 6F                  A    55    	LD	L,A
04020B E5                  A    56    	PUSH	HL
04020C CD 41 03 04         A    57    	CALL	_putch
040210 C1                  A    58    	POP	BC
                           A    59    ;   10	}
                           A    60    .LINE 10
                           A    61    
040211 DDF9                A    62    	LD	SP,IX
040213 DDE1                A    63    	POP	IX
040215 C9                  A    64    	RET	
                           A    65    
                           A    66    
                           A    67    ;**************************** _vdp_mode *******
                           A    68    ;Name                         Addr/Register   S
                           A    69    ;_putch                              IMPORT  --
                           A    70    ;mode                                  IX+6    
                           A    71    
                           A    72    
                           A    73    ; Stack Frame Size: 9 (bytes)
                           A    74    ;       Spill Code: 0 (instruction)
                           A    75    
                           A    76    
                           A    77    .ENDFUNC "vdp_mode",10,"_vdp_mode"
                           A    78    ;   11	
                           A    79    ;   12	// Text functions
                           A    80    ;   13	void vdp_cls()
                           A    81    ;   14	{
040216                     A    82    _vdp_cls:
                           A    83    .DEFINE "_vdp_cls"
                           A    84    
                           A    85    .VALUE _vdp_cls
                           A    86    
                           A    87    .CLASS 2
                           A    88    
                           A    89    .TYPE 65
                           A    90    
                           A    91    .ENDEF
                           A    92    
                           A    93    .BEGFUNC "vdp_cls",14,"_vdp_cls"
                           A    94    
040216 DDE5                A    95    	PUSH	IX
040218 DD210000 00         A    96    	LD	IX,0
04021D DD39                A    97    	ADD	IX,SP
                           A    98    ;   15	    putch(12);
                           A    99    .LINE 15
                           A   100    
04021F 010C0000            A   101    	LD	BC,12
040223 C5                  A   102    	PUSH	BC
040224 CD 41 03 04         A   103    	CALL	_putch
040228 C1                  A   104    	POP	BC
                           A   105    ;   16	}
                           A   106    .LINE 16
                           A   107    
040229 DDF9                A   108    	LD	SP,IX
04022B DDE1                A   109    	POP	IX
04022D C9                  A   110    	RET	
                           A   111    
                           A   112    
                           A   113    ;**************************** _vdp_cls ********
                           A   114    ;Name                         Addr/Register   S
                           A   115    ;_putch                              IMPORT  --
                           A   116    
                           A   117    
                           A   118    ; Stack Frame Size: 6 (bytes)
                           A   119    ;       Spill Code: 0 (instruction)
                           A   120    
                           A   121    
                           A   122    .ENDFUNC "vdp_cls",16,"_vdp_cls"
                           A   123    ;   17	
                           A   124    ;   18	void vdp_cursorHome()
                           A   125    ;   19	{
04022E                     A   126    _vdp_cursorHome:
                           A   127    .DEFINE "_vdp_cursorHome"
                           A   128    
                           A   129    .VALUE _vdp_cursorHome
                           A   130    
                           A   131    .CLASS 2
                           A   132    
                           A   133    .TYPE 65
                           A   134    
                           A   135    .ENDEF
                           A   136    
                           A   137    .BEGFUNC "vdp_cursorHome",19,"_vdp_cursorHome"
                           A   138    
04022E DDE5                A   139    	PUSH	IX
040230 DD210000 00         A   140    	LD	IX,0
040235 DD39                A   141    	ADD	IX,SP
                           A   142    ;   20	    putch(30);
                           A   143    .LINE 20
                           A   144    
040237 011E0000            A   145    	LD	BC,30
04023B C5                  A   146    	PUSH	BC
04023C CD 41 03 04         A   147    	CALL	_putch
040240 C1                  A   148    	POP	BC
                           A   149    ;   21	}
                           A   150    .LINE 21
                           A   151    
040241 DDF9                A   152    	LD	SP,IX
040243 DDE1                A   153    	POP	IX
040245 C9                  A   154    	RET	
                           A   155    
                           A   156    
                           A   157    ;**************************** _vdp_cursorHome *
                           A   158    ;Name                         Addr/Register   S
                           A   159    ;_putch                              IMPORT  --
                           A   160    
                           A   161    
                           A   162    ; Stack Frame Size: 6 (bytes)
                           A   163    ;       Spill Code: 0 (instruction)
                           A   164    
                           A   165    
                           A   166    .ENDFUNC "vdp_cursorHome",21,"_vdp_cursorHome"
                           A   167    ;   22	
                           A   168    ;   23	void vdp_cursorUp()
                           A   169    ;   24	{
040246                     A   170    _vdp_cursorUp:
                           A   171    .DEFINE "_vdp_cursorUp"
                           A   172    
                           A   173    .VALUE _vdp_cursorUp
                           A   174    
                           A   175    .CLASS 2
                           A   176    
                           A   177    .TYPE 65
                           A   178    
                           A   179    .ENDEF
                           A   180    
                           A   181    .BEGFUNC "vdp_cursorUp",24,"_vdp_cursorUp"
                           A   182    
040246 DDE5                A   183    	PUSH	IX
040248 DD210000 00         A   184    	LD	IX,0
04024D DD39                A   185    	ADD	IX,SP
                           A   186    ;   25	    putch(11);
                           A   187    .LINE 25
                           A   188    
04024F 010B0000            A   189    	LD	BC,11
040253 C5                  A   190    	PUSH	BC
040254 CD 41 03 04         A   191    	CALL	_putch
040258 C1                  A   192    	POP	BC
                           A   193    ;   26	}
                           A   194    .LINE 26
                           A   195    
040259 DDF9                A   196    	LD	SP,IX
04025B DDE1                A   197    	POP	IX
04025D C9                  A   198    	RET	
                           A   199    
                           A   200    
                           A   201    ;**************************** _vdp_cursorUp ***
                           A   202    ;Name                         Addr/Register   S
                           A   203    ;_putch                              IMPORT  --
                           A   204    
                           A   205    
                           A   206    ; Stack Frame Size: 6 (bytes)
                           A   207    ;       Spill Code: 0 (instruction)
                           A   208    
                           A   209    
                           A   210    .ENDFUNC "vdp_cursorUp",26,"_vdp_cursorUp"
                           A   211    ;   27	
                           A   212    ;   28	void vdp_cursorGoto(unsigned char x, un
                           A   213    ;   29	{
04025E                     A   214    _vdp_cursorGoto:
                           A   215    .DEFINE "_vdp_cursorGoto"
                           A   216    
                           A   217    .VALUE _vdp_cursorGoto
                           A   218    
                           A   219    .CLASS 2
                           A   220    
                           A   221    .TYPE 65
                           A   222    
                           A   223    .ENDEF
                           A   224    
                           A   225    .BEGFUNC "vdp_cursorGoto",29,"_vdp_cursorGoto"
                           A   226    
                           A   227    .LINE 29
                           A   228    
                           A   229    .DEFINE "x"
                           A   230    
                           A   231    .CLASS 65
                           A   232    
                           A   233    .VALUE 6
                           A   234    
                           A   235    .TYPE 12
                           A   236    
                           A   237    .ENDEF
                           A   238    
                           A   239    .DEFINE "y"
                           A   240    
                           A   241    .CLASS 65
                           A   242    
                           A   243    .VALUE 9
                           A   244    
                           A   245    .TYPE 12
                           A   246    
                           A   247    .ENDEF
                           A   248    
04025E DDE5                A   249    	PUSH	IX
040260 DD210000 00         A   250    	LD	IX,0
040265 DD39                A   251    	ADD	IX,SP
                           A   252    ;   30	    putch(31); // TAB
                           A   253    .LINE 30
                           A   254    
040267 011F0000            A   255    	LD	BC,31
04026B C5                  A   256    	PUSH	BC
04026C CD 41 03 04         A   257    	CALL	_putch
040270 C1                  A   258    	POP	BC
                           A   259    ;   31	    putch(x);
                           A   260    .LINE 31
                           A   261    
040271 DD7E06              A   262    	LD	A,(IX+%6)
040274 B7ED62              A   263    	UEXT	HL
040277 6F                  A   264    	LD	L,A
040278 E5                  A   265    	PUSH	HL
040279 CD 41 03 04         A   266    	CALL	_putch
04027D C1                  A   267    	POP	BC
                           A   268    ;   32	    putch(y);
                           A   269    .LINE 32
                           A   270    
04027E DD7E09              A   271    	LD	A,(IX+%9)
040281 B7ED62              A   272    	UEXT	HL
040284 6F                  A   273    	LD	L,A
040285 E5                  A   274    	PUSH	HL
040286 CD 41 03 04         A   275    	CALL	_putch
04028A C1                  A   276    	POP	BC
                           A   277    ;   33	}
                           A   278    .LINE 33
                           A   279    
04028B DDF9                A   280    	LD	SP,IX
04028D DDE1                A   281    	POP	IX
04028F C9                  A   282    	RET	
                           A   283    
                           A   284    
                           A   285    ;**************************** _vdp_cursorGoto *
                           A   286    ;Name                         Addr/Register   S
                           A   287    ;_putch                              IMPORT  --
                           A   288    ;y                                     IX+9    
                           A   289    ;x                                     IX+6    
                           A   290    
                           A   291    
                           A   292    ; Stack Frame Size: 12 (bytes)
                           A   293    ;       Spill Code: 0 (instruction)
                           A   294    
                           A   295    
                           A   296    .ENDFUNC "vdp_cursorGoto",33,"_vdp_cursorGoto"
                           A   297    ;   34	
                           A   298    ;   35	void vdp_colour(unsigned char foregroun
                           A   299    ;   36	{
040290                     A   300    _vdp_colour:
                           A   301    .DEFINE "_vdp_colour"
                           A   302    
                           A   303    .VALUE _vdp_colour
                           A   304    
                           A   305    .CLASS 2
                           A   306    
                           A   307    .TYPE 65
                           A   308    
                           A   309    .ENDEF
                           A   310    
                           A   311    .BEGFUNC "vdp_colour",36,"_vdp_colour"
                           A   312    
                           A   313    .LINE 36
                           A   314    
                           A   315    .DEFINE "foreground"
                           A   316    
                           A   317    .CLASS 65
                           A   318    
                           A   319    .VALUE 6
                           A   320    
                           A   321    .TYPE 12
                           A   322    
                           A   323    .ENDEF
                           A   324    
                           A   325    .DEFINE "r"
                           A   326    
                           A   327    .CLASS 65
                           A   328    
                           A   329    .VALUE 9
                           A   330    
                           A   331    .TYPE 12
                           A   332    
                           A   333    .ENDEF
                           A   334    
                           A   335    .DEFINE "g"
                           A   336    
                           A   337    .CLASS 65
                           A   338    
                           A   339    .VALUE 12
                           A   340    
                           A   341    .TYPE 12
                           A   342    
                           A   343    .ENDEF
                           A   344    
                           A   345    .DEFINE "b"
                           A   346    
                           A   347    .CLASS 65
                           A   348    
                           A   349    .VALUE 15
                           A   350    
                           A   351    .TYPE 12
                           A   352    
                           A   353    .ENDEF
                           A   354    
040290 DDE5                A   355    	PUSH	IX
040292 DD210000 00         A   356    	LD	IX,0
040297 DD39                A   357    	ADD	IX,SP
040299 C5                  A   358    	PUSH	BC
                           A   359    ;   37	    putch(17); // COLOUR
                           A   360    .LINE 37
                           A   361    
04029A 01110000            A   362    	LD	BC,17
04029E C5                  A   363    	PUSH	BC
04029F CD 41 03 04         A   364    	CALL	_putch
0402A3 C1                  A   365    	POP	BC
                           A   366    ;   38	    putch(!foreground);
                           A   367    .LINE 38
                           A   368    
0402A4 DD7E06              A   369    	LD	A,(IX+%6)
0402A7 B7                  A   370    	OR	A,A
0402A8 20 09               A   371    	JR	NZ,L_6
0402AA 01010000            A   372    	LD	BC,1
0402AE DD0FFD              A   373    	LD	(IX+%FFFFFFFD),BC
0402B1 18 07               A   374    	JR	L_7
0402B3                     A   375    L_6:
0402B3 01000000            A   376    	LD	BC,0
0402B7 DD0FFD              A   377    	LD	(IX+%FFFFFFFD),BC
0402BA                     A   378    L_7:
0402BA DD07FD              A   379    	LD	BC,(IX+%FFFFFFFD)
0402BD C5                  A   380    	PUSH	BC
0402BE CD 41 03 04         A   381    	CALL	_putch
0402C2 C1                  A   382    	POP	BC
                           A   383    ;   39	    putch(r);
                           A   384    .LINE 39
                           A   385    
0402C3 DD7E09              A   386    	LD	A,(IX+%9)
0402C6 B7ED62              A   387    	UEXT	HL
0402C9 6F                  A   388    	LD	L,A
0402CA E5                  A   389    	PUSH	HL
0402CB CD 41 03 04         A   390    	CALL	_putch
0402CF C1                  A   391    	POP	BC
                           A   392    ;   40	    putch(g);
                           A   393    .LINE 40
                           A   394    
0402D0 DD7E0C              A   395    	LD	A,(IX+%C)
0402D3 B7ED62              A   396    	UEXT	HL
0402D6 6F                  A   397    	LD	L,A
0402D7 E5                  A   398    	PUSH	HL
0402D8 CD 41 03 04         A   399    	CALL	_putch
0402DC C1                  A   400    	POP	BC
                           A   401    ;   41	    putch(b);
                           A   402    .LINE 41
                           A   403    
0402DD DD7E0F              A   404    	LD	A,(IX+%F)
0402E0 B7ED62              A   405    	UEXT	HL
0402E3 6F                  A   406    	LD	L,A
0402E4 E5                  A   407    	PUSH	HL
0402E5 CD 41 03 04         A   408    	CALL	_putch
0402E9 C1                  A   409    	POP	BC
                           A   410    ;   42	}
                           A   411    .LINE 42
                           A   412    
0402EA DDF9                A   413    	LD	SP,IX
0402EC DDE1                A   414    	POP	IX
0402EE C9                  A   415    	RET	
                           A   416    
                           A   417    
                           A   418    ;**************************** _vdp_colour *****
                           A   419    ;Name                         Addr/Register   S
                           A   420    ;_putch                              IMPORT  --
                           A   421    ;temp8                                 IX-3    
                           A   422    ;b                                    IX+15    
                           A   423    ;g                                    IX+12    
                           A   424    ;r                                     IX+9    
                           A   425    ;foreground                            IX+6    
                           A   426    
                           A   427    
                           A   428    ; Stack Frame Size: 21 (bytes)
                           A   429    ;       Spill Code: 0 (instruction)
                           A   430    
                           A   431    
                           A   432    .ENDFUNC "vdp_colour",42,"_vdp_colour"
                           A   433    ;   43	
                           A   434    ;   44	void vdp_fgcolour(unsigned char r, unsi
                           A   435    ;   45	{
0402EF                     A   436    _vdp_fgcolour:
                           A   437    .DEFINE "_vdp_fgcolour"
                           A   438    
                           A   439    .VALUE _vdp_fgcolour
                           A   440    
                           A   441    .CLASS 2
                           A   442    
                           A   443    .TYPE 65
                           A   444    
                           A   445    .ENDEF
                           A   446    
                           A   447    .BEGFUNC "vdp_fgcolour",45,"_vdp_fgcolour"
                           A   448    
                           A   449    .LINE 45
                           A   450    
                           A   451    .DEFINE "r"
                           A   452    
                           A   453    .CLASS 65
                           A   454    
                           A   455    .VALUE 6
                           A   456    
                           A   457    .TYPE 12
                           A   458    
                           A   459    .ENDEF
                           A   460    
                           A   461    .DEFINE "g"
                           A   462    
                           A   463    .CLASS 65
                           A   464    
                           A   465    .VALUE 9
                           A   466    
                           A   467    .TYPE 12
                           A   468    
                           A   469    .ENDEF
                           A   470    
                           A   471    .DEFINE "b"
                           A   472    
                           A   473    .CLASS 65
                           A   474    
                           A   475    .VALUE 12
                           A   476    
                           A   477    .TYPE 12
                           A   478    
                           A   479    .ENDEF
                           A   480    
0402EF DDE5                A   481    	PUSH	IX
0402F1 DD210000 00         A   482    	LD	IX,0
0402F6 DD39                A   483    	ADD	IX,SP
                           A   484    ;   46	    vdp_colour(1,r,g,b);
                           A   485    .LINE 46
                           A   486    
0402F8 DD4E0C              A   487    	LD	C,(IX+%C)
0402FB 0600                A   488    	LD	B,%0
0402FD C5                  A   489    	PUSH	BC
0402FE DD4E09              A   490    	LD	C,(IX+%9)
040301 C5                  A   491    	PUSH	BC
040302 DD4E06              A   492    	LD	C,(IX+%6)
040305 C5                  A   493    	PUSH	BC
040306 01010000            A   494    	LD	BC,1
04030A C5                  A   495    	PUSH	BC
04030B CD 90 02 04         A   496    	CALL	_vdp_colour
04030F C1                  A   497    	POP	BC
040310 C1                  A   498    	POP	BC
040311 C1                  A   499    	POP	BC
040312 C1                  A   500    	POP	BC
                           A   501    ;   47	}
                           A   502    .LINE 47
                           A   503    
040313 DDF9                A   504    	LD	SP,IX
040315 DDE1                A   505    	POP	IX
040317 C9                  A   506    	RET	
                           A   507    
                           A   508    
                           A   509    ;**************************** _vdp_fgcolour ***
                           A   510    ;Name                         Addr/Register   S
                           A   511    ;b                                    IX+12    
                           A   512    ;g                                     IX+9    
                           A   513    ;r                                     IX+6    
                           A   514    
                           A   515    
                           A   516    ; Stack Frame Size: 15 (bytes)
                           A   517    ;       Spill Code: 0 (instruction)
                           A   518    
                           A   519    
                           A   520    .ENDFUNC "vdp_fgcolour",47,"_vdp_fgcolour"
                           A   521    ;   48	
                           A   522    ;   49	void vdp_bgcolour(unsigned char r, unsi
                           A   523    ;   50	{
040318                     A   524    _vdp_bgcolour:
                           A   525    .DEFINE "_vdp_bgcolour"
                           A   526    
                           A   527    .VALUE _vdp_bgcolour
                           A   528    
                           A   529    .CLASS 2
                           A   530    
                           A   531    .TYPE 65
                           A   532    
                           A   533    .ENDEF
                           A   534    
                           A   535    .BEGFUNC "vdp_bgcolour",50,"_vdp_bgcolour"
                           A   536    
                           A   537    .LINE 50
                           A   538    
                           A   539    .DEFINE "r"
                           A   540    
                           A   541    .CLASS 65
                           A   542    
                           A   543    .VALUE 6
                           A   544    
                           A   545    .TYPE 12
                           A   546    
                           A   547    .ENDEF
                           A   548    
                           A   549    .DEFINE "g"
                           A   550    
                           A   551    .CLASS 65
                           A   552    
                           A   553    .VALUE 9
                           A   554    
                           A   555    .TYPE 12
                           A   556    
                           A   557    .ENDEF
                           A   558    
                           A   559    .DEFINE "b"
                           A   560    
                           A   561    .CLASS 65
                           A   562    
                           A   563    .VALUE 12
                           A   564    
                           A   565    .TYPE 12
                           A   566    
                           A   567    .ENDEF
                           A   568    
040318 DDE5                A   569    	PUSH	IX
04031A DD210000 00         A   570    	LD	IX,0
04031F DD39                A   571    	ADD	IX,SP
                           A   572    ;   51	    vdp_colour(0,r,g,b);
                           A   573    .LINE 51
                           A   574    
040321 DD4E0C              A   575    	LD	C,(IX+%C)
040324 0600                A   576    	LD	B,%0
040326 C5                  A   577    	PUSH	BC
040327 DD4E09              A   578    	LD	C,(IX+%9)
04032A C5                  A   579    	PUSH	BC
04032B DD4E06              A   580    	LD	C,(IX+%6)
04032E C5                  A   581    	PUSH	BC
04032F 01000000            A   582    	LD	BC,0
040333 C5                  A   583    	PUSH	BC
040334 CD 90 02 04         A   584    	CALL	_vdp_colour
040338 C1                  A   585    	POP	BC
040339 C1                  A   586    	POP	BC
04033A C1                  A   587    	POP	BC
04033B C1                  A   588    	POP	BC
                           A   589    ;   52	}
                           A   590    .LINE 52
                           A   591    
04033C DDF9                A   592    	LD	SP,IX
04033E DDE1                A   593    	POP	IX
040340 C9                  A   594    	RET	
                           A   595    
                           A   596    
                           A   597    ;**************************** _vdp_bgcolour ***
                           A   598    ;Name                         Addr/Register   S
                           A   599    ;b                                    IX+12    
                           A   600    ;g                                     IX+9    
                           A   601    ;r                                     IX+6    
                           A   602    
                           A   603    
                           A   604    ; Stack Frame Size: 15 (bytes)
                           A   605    ;       Spill Code: 0 (instruction)
                           A   606    
                           A   607    
                           A   608    .ENDFUNC "vdp_bgcolour",52,"_vdp_bgcolour"
                           A   609    	XREF _putch:ROM
                           A   610    	XDEF _vdp_bgcolour
                           A   611    	XDEF _vdp_fgcolour
                           A   612    	XDEF _vdp_colour
                           A   613    	XDEF _vdp_cursorGoto
                           A   614    	XDEF _vdp_cursorUp
                           A   615    	XDEF _vdp_cursorHome
                           A   616    	XDEF _vdp_cls
                           A   617    	XDEF _vdp_mode
                           A   618    	END


Errors: 0
Warnings: 0
Lines Assembled: 619
